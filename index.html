<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pizzaria Del√≠cia</title>
  <style>
    body {
      margin: 0; 
      padding: 0; 
      font-family: Arial, sans-serif; 
      background: #fff8f0;
      padding-top: 120px;
      padding-bottom: 180px;
    }
    header {
      position: fixed;
      top: 0; 
      left: 0; 
      right: 0;
      height: 60px;
      background: #d84315;
      color: white;
      display: flex;
      align-items: center;
      padding: 0 20px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
      z-index: 1000;
    }
    header img {
      height: 40px;
      margin-right: 12px;
    }
    header h1 {
      font-size: 24px;
      margin: 0;
      font-weight: bold;
    }
    main {
      max-width: 1000px;
      margin: 20px auto;
    }
    .pizza-menu {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 18px;
    }
    .pizza-card {
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgb(216 148 125 / 0.5);
      cursor: pointer;
      transition: transform 0.15s ease;
      font-size: 18px;
      display: flex;
      flex-direction: column;
    }
    .pizza-card:hover {
      transform: scale(1.05);
    }
    .pizza-card img {
      width: 100%;
      border-radius: 8px 8px 0 0;
      height: 160px;
      object-fit: cover;
    }
    .pizza-info {
      padding: 14px 16px 18px;
      flex-grow: 1;
      display: flex;
      flex-direction: column;
    }
    .pizza-name {
      margin: 0 0 6px 0;
      font-size: 22px;
      font-weight: bold;
    }
    .pizza-ingredients {
      margin: 0 0 10px 0;
      color: #555;
      flex-grow: 1;
    }
    .pizza-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 700;
      font-size: 20px;
      color: #d84315;
    }
    .cart-container {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: #fff3e0;
      box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
      z-index: 999;
      padding: 15px 0;
    }
    .cart-section {
      max-width: 1000px;
      margin: 0 auto;
      padding: 0 20px;
    }
    .cart-section h2 {
      margin-top: 0;
      font-size: 26px;
      color: #d84315;
      margin-bottom: 10px;
    }
    .cart-list {
      list-style: none;
      padding: 0;
      margin: 0 0 10px 0;
      max-height: 200px;
      overflow-y: auto;
    }
    .cart-list li {
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-size: 18px;
      padding: 8px 0;
      border-bottom: 1px solid #d8431540;
    }
    .item-name {
      flex: 1;
      font-size: 16px;
    }
    .quantity-controls {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .quantity-controls button {
      background: #d84315;
      color: white;
      border: none;
      border-radius: 4px;
      width: 30px;
      height: 30px;
      font-size: 22px;
      cursor: pointer;
      user-select: none;
    }
    .item-price {
      margin-left: 15px;
      width: 80px;
      text-align: right;
      font-weight: 700;
      font-size: 16px;
    }
    .btn-meia {
      margin-left: 15px;
      background: #ff7043;
      color: white;
      border: none;
      border-radius: 4px;
      padding: 6px 10px;
      cursor: pointer;
      font-size: 16px;
      user-select: none;
      transition: background 0.3s ease;
    }
    .btn-meia:hover {
      background: #e64a19;
    }
    .total {
      font-size: 22px;
      font-weight: 700;
      text-align: right;
      color: #d84315;
      padding: 10px 0;
      border-top: 2px solid #d84315;
    }
    .empty-cart {
      text-align: center;
      color: #666;
      font-style: italic;
      padding: 20px 0;
    }

    /* Novo estilo para o bot√£o de alternar menu - agora na parte superior */
    .toggle-menu {
      position: fixed;
      top: 70px; /* Posicionado logo abaixo do header */
      left: 0;
      right: 0;
      height: 50px;
      background: #ff7043;
      color: white;
      border: none;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
      z-index: 999;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }
    .toggle-menu:hover {
      background: #e64a19;
    }
    .toggle-menu::before {
      content: "üç∫ ";
    }
    .toggle-menu::after {
      content: " üçï";
    }

    /* Bot√£o Finalizar Pedido */
    .btn-finalizar {
      background: #d84315;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 12px 24px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      margin-top: 10px;
      width: 100%;
      transition: background 0.3s ease;
    }
    .btn-finalizar:hover {
      background: #e64a19;
    }
    .btn-finalizar:disabled {
      background: #cccccc;
      cursor: not-allowed;
    }

    /* Modal de Finaliza√ß√£o */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      z-index: 2000;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }
    .modal-overlay.active {
      opacity: 1;
      pointer-events: all;
    }
    .modal-content {
      background: white;
      border-radius: 10px;
      width: 90%;
      max-width: 500px;
      padding: 25px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
      transform: translateY(20px);
      transition: transform 0.3s ease;
    }
    .modal-overlay.active .modal-content {
      transform: translateY(0);
    }
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    .modal-header h2 {
      margin: 0;
      color: #d84315;
    }
    .close-modal {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: #666;
    }
    .form-group {
      margin-bottom: 15px;
    }
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
      color: #555;
    }
    .form-group input, .form-group select, .form-group textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-size: 16px;
    }
    .form-group textarea {
      height: 80px;
      resize: vertical;
    }
    .address-fields {
      display: flex;
      gap: 10px;
    }
    .address-fields .form-group {
      flex: 1;
    }
    .address-fields .form-group:first-child {
      flex: 3;
    }
    .address-fields .form-group:nth-child(2) {
      flex: 1;
      max-width: 100px;
    }
    .btn-enviar {
      background: #4CAF50;
      color: white;
      border: none;
      border-radius: 5px;
      padding: 12px 20px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      width: 100%;
      margin-top: 10px;
      transition: background 0.3s ease;
    }
    .btn-enviar:hover {
      background: #45a049;
    }

    /* Responsividade para telas menores */
    @media (max-width: 768px) {
      body {
        padding-top: 110px;
      }
      .pizza-menu {
        grid-template-columns: 1fr;
      }
      .toggle-menu {
        height: 45px;
        font-size: 16px;
      }
      .address-fields {
        flex-direction: column;
      }
      .address-fields .form-group:nth-child(2) {
        max-width: none;
      }
    }
  </style>
</head>
<body>
  <header>
    <img src="https://img.icons8.com/ios-filled/50/ffffff/pizza.png" alt="Logo Pizzaria" />
    <h1>Pizzaria Del√≠cia</h1>
  </header>
  
  <button class="toggle-menu" id="toggleMenu">Ir para BEBIDAS</button>
  
  <main>
    <section class="pizza-menu" id="menu"></section>
  </main>
  
  <div class="cart-container">
    <section class="cart-section" id="cart">
      <h2>Resumo do Pedido</h2>
      <div id="empty-cart" class="empty-cart">Seu carrinho est√° vazio</div>
      <ul id="cart-list" class="cart-list"></ul>
      <div id="total" class="total"></div>
      <button id="btnFinalizar" class="btn-finalizar" disabled>Finalizar Pedido</button>
    </section>
  </div>

  <!-- Modal de Finaliza√ß√£o -->
  <div class="modal-overlay" id="modalFinalizar">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Finalizar Pedido</h2>
        <button class="close-modal" id="closeModal">&times;</button>
      </div>
      <form id="formFinalizar">
        <div class="address-fields">
          <div class="form-group">
            <label for="endereco">Endere√ßo</label>
            <input type="text" id="endereco" required placeholder="Rua, Avenida, etc">
          </div>
          <div class="form-group">
            <label for="numero">N√∫mero</label>
            <input type="text" id="numero" required placeholder="N¬∫">
          </div>
        </div>
        <div class="form-group">
          <label for="complemento">Complemento (opcional)</label>
          <input type="text" id="complemento" placeholder="Ap, Torre, Condom√≠nio, etc">
        </div>
        <div class="form-group">
          <label for="pagamento">Forma de Pagamento</label>
          <select id="pagamento" required>
            <option value="">Selecione...</option>
            <option value="Dinheiro">Dinheiro</option>
            <option value="Cart√£o de Cr√©dito">Cart√£o de Cr√©dito</option>
            <option value="Cart√£o de D√©bito">Cart√£o de D√©bito</option>
            <option value="PIX">PIX</option>
          </select>
        </div>
        <div class="form-group" id="trocoField" style="display: none;">
          <label for="troco">Troco para (opcional)</label>
          <input type="text" id="troco" placeholder="R$ 0,00">
        </div>
        <button type="submit" class="btn-enviar">Enviar Pedido via WhatsApp</button>
      </form>
    </div>
  </div>

  <script>
    const pizzas = [
      { id: 1, name: "Margherita", ingredients: "Molho de tomate, mussarela, manjeric√£o", price: 30, image: "https://images.unsplash.com/photo-1601924582975-1a3a8af6f3f6?auto=format&fit=crop&w=600&q=80" },
      { id: 2, name: "Pepperoni", ingredients: "Molho de tomate, mussarela, pepperoni", price: 38, image: "https://images.unsplash.com/photo-1594007650864-ff4c6382da46?auto=format&fit=crop&w=600&q=80" },
      { id: 3, name: "Quatro Queijos", ingredients: "Mussarela, parmes√£o, gorgonzola, provolone", price: 42, image: "https://images.unsplash.com/photo-1548365328-c7a8c4a3d6ca?auto=format&fit=crop&w=600&q=80" },
      { id: 4, name: "Frango com Catupiry", ingredients: "Frango desfiado, catupiry, milho", price: 40, image: "https://images.unsplash.com/photo-1578165307967-37fa27bb0b81?auto=format&fit=crop&w=600&q=80" },
      { id: 5, name: "Portuguesa", ingredients: "Presunto, ovos, cebola, azeitonas", price: 35, image: "https://images.unsplash.com/photo-1548365328-c7a8c4a3d6ca?auto=format&fit=crop&w=600&q=80" },
      { id: 6, name: "Vegana", ingredients: "Molho de tomate, legumes variados, queijo vegano", price: 37, image: "https://images.unsplash.com/photo-1504674900247-0877df9cc836?auto=format&fit=crop&w=600&q=80" }
    ];

    const bebidas = [
      { id: 101, name: "Coca-Cola 2L", price: 12, image: "https://images.unsplash.com/photo-1554866585-cd94860890b7?auto=format&fit=crop&w=600&q=80" },
      { id: 102, name: "Guaran√° Antarctica 2L", price: 10, image: "https://images.unsplash.com/photo-1625772452859-1c03d5bf1137?auto=format&fit=crop&w=600&q=80" },
      { id: 103, name: "Suco de Laranja 1L", price: 15, image: "https://images.unsplash.com/photo-1603569283847-aa295f0d016a?auto=format&fit=crop&w=600&q=80" },
      { id: 104, name: "√Ågua Mineral 500ml", price: 5, image: "https://images.unsplash.com/photo-1561047029-3000c68339ca?auto=format&fit=crop&w=600&q=80" },
      { id: 105, name: "Cerveja Heineken 600ml", price: 14, image: "https://images.unsplash.com/photo-1618889482923-38250401a84e?auto=format&fit=crop&w=600&q=80" },
      { id: 106, name: "Vinho Tinto 750ml", price: 45, image: "https://images.unsplash.com/photo-1510812431401-41d2bd2722f3?auto=format&fit=crop&w=600&q=80" }
    ];

    const menuEl = document.getElementById('menu');
    const cartList = document.getElementById('cart-list');
    const totalEl = document.getElementById('total');
    const emptyCartEl = document.getElementById('empty-cart');
    const toggleMenuBtn = document.getElementById('toggleMenu');
    const btnFinalizar = document.getElementById('btnFinalizar');
    const modalFinalizar = document.getElementById('modalFinalizar');
    const closeModal = document.getElementById('closeModal');
    const formFinalizar = document.getElementById('formFinalizar');
    const pagamentoSelect = document.getElementById('pagamento');
    const trocoField = document.getElementById('trocoField');
    
    let carrinho = [];
    let meiaPizzaPendente = null;
    let exibindoBebidas = false;

    // Fun√ß√£o para alternar entre pizzas e bebidas
    function toggleMenu() {
      exibindoBebidas = !exibindoBebidas;
      toggleMenuBtn.textContent = exibindoBebidas ? "Ir para PIZZAS" : "Ir para BEBIDAS";
      renderMenu();
    }

    function renderMenu() {
      menuEl.innerHTML = '';
      const itens = exibindoBebidas ? bebidas : pizzas;
      
      itens.forEach(item => {
        const card = document.createElement('article');
        card.classList.add('pizza-card');
        card.dataset.id = item.id;

        card.innerHTML = `
          <img src="${item.image}" alt="${item.name}" />
          <div class="pizza-info">
            <h3 class="pizza-name">${item.name}</h3>
            ${!exibindoBebidas ? `<p class="pizza-ingredients">${item.ingredients}</p>` : ''}
            <div class="pizza-footer">
              <div class="pizza-price">R$ ${item.price.toFixed(2)}</div>
            </div>
          </div>
        `;

        if (!exibindoBebidas) {
          const meiaBtn = document.createElement('button');
          meiaBtn.textContent = 'Meia';
          meiaBtn.className = 'btn-meia';
          meiaBtn.onclick = (ev) => {
            ev.stopPropagation();
            addMeiaPizza(item.id);
          };
          card.querySelector('.pizza-footer').appendChild(meiaBtn);
        }

        card.addEventListener('click', () => {
          if (exibindoBebidas) {
            addBebidaToCart(item.id);
          } else {
            addPizzaToCart(item.id);
          }
        });
        
        menuEl.appendChild(card);
      });
    }

    function addPizzaToCart(pizzaId) {
      if (meiaPizzaPendente !== null) {
        const nova = [meiaPizzaPendente, pizzaId].sort((a,b) => a-b);
        const existente = carrinho.find(i => i.type === 'meia' && i.pizzas.length === 2 && i.pizzas.join() === nova.join());
        
        if (existente) {
          existente.quantity++;
          existente.timestamp = Date.now();
        } else {
          carrinho.push({ 
            type: 'meia', 
            pizzas: nova, 
            quantity: 1,
            timestamp: Date.now()
          });
        }
        
        const idxPendente = carrinho.findIndex(item => item.type === 'meia' && item.pizzas.length === 1 && item.pizzas[0] === meiaPizzaPendente);
        if (idxPendente >= 0) {
          carrinho.splice(idxPendente, 1);
        }
        
        meiaPizzaPendente = null;
      } else {
        const idx = carrinho.findIndex(item => item.type === 'inteira' && item.pizzaId === pizzaId);
        if (idx >= 0) {
          carrinho[idx].quantity++;
          carrinho[idx].timestamp = Date.now();
        } else {
          carrinho.push({ 
            type: 'inteira', 
            pizzaId, 
            quantity: 1,
            timestamp: Date.now()
          });
        }
      }
      renderCart();
    }

    function addBebidaToCart(bebidaId) {
      const idx = carrinho.findIndex(item => item.type === 'bebida' && item.bebidaId === bebidaId);
      if (idx >= 0) {
        carrinho[idx].quantity++;
        carrinho[idx].timestamp = Date.now();
      } else {
        carrinho.push({ 
          type: 'bebida', 
          bebidaId, 
          quantity: 1,
          timestamp: Date.now()
        });
      }
      renderCart();
    }

    function addMeiaPizza(pizzaId) {
      if (meiaPizzaPendente !== null && meiaPizzaPendente !== pizzaId) {
        const nova = [meiaPizzaPendente, pizzaId].sort((a,b) => a-b);
        const existente = carrinho.find(i => i.type === 'meia' && i.pizzas.length === 2 && i.pizzas.join() === nova.join());
        
        if (existente) {
          existente.quantity++;
          existente.timestamp = Date.now();
        } else {
          carrinho.push({ 
            type: 'meia', 
            pizzas: nova, 
            quantity: 1,
            timestamp: Date.now()
          });
        }
        
        const idxPendente = carrinho.findIndex(item => item.type === 'meia' && item.pizzas.length === 1 && item.pizzas[0] === meiaPizzaPendente);
        if (idxPendente >= 0) {
          carrinho.splice(idxPendente, 1);
        }
        
        meiaPizzaPendente = null;
      } else {
        meiaPizzaPendente = pizzaId;
        
        const existente = carrinho.find(i => i.type === 'meia' && i.pizzas.length === 1 && i.pizzas[0] === pizzaId);
        if (existente) {
          existente.quantity++;
          existente.timestamp = Date.now();
        } else {
          carrinho.push({ 
            type: 'meia', 
            pizzas: [pizzaId], 
            quantity: 1,
            timestamp: Date.now()
          });
        }
      }
      renderCart();
    }

    function renderCart() {
      if (carrinho.length === 0) {
        emptyCartEl.style.display = 'block';
        cartList.style.display = 'none';
        totalEl.style.display = 'none';
        btnFinalizar.disabled = true;
        return;
      }
      
      emptyCartEl.style.display = 'none';
      cartList.style.display = 'block';
      totalEl.style.display = 'block';
      btnFinalizar.disabled = false;
      cartList.innerHTML = '';

      // Ordena os itens por timestamp (mais recente primeiro)
      const carrinhoOrdenado = [...carrinho].sort((a, b) => b.timestamp - a.timestamp);

      carrinhoOrdenado.forEach((item, index) => {
        const originalIndex = carrinho.findIndex(i => i.timestamp === item.timestamp);
        const li = document.createElement('li');
        let name, price;

        if (item.type === 'inteira') {
          const pizza = pizzas.find(p => p.id === item.pizzaId);
          name = pizza.name;
          price = pizza.price;
        } else if (item.type === 'meia') {
          if (item.pizzas.length === 1) {
            const pizza = pizzas.find(p => p.id === item.pizzas[0]);
            name = `Meia pizza de ${pizza.name} (escolha outra metade)`;
            price = pizza.price / 2;
          } else if (item.pizzas.length === 2) {
            const pizza1 = pizzas.find(p => p.id === item.pizzas[0]);
            const pizza2 = pizzas.find(p => p.id === item.pizzas[1]);
            name = `Meia ${pizza1.name} + meia ${pizza2.name}`;
            price = Math.max(pizza1.price, pizza2.price);
          }
        } else if (item.type === 'bebida') {
          const bebida = bebidas.find(b => b.id === item.bebidaId);
          name = bebida.name;
          price = bebida.price;
        }

        const itemTotalPrice = price * item.quantity;

        li.innerHTML = `
          <div class="item-name">${name}</div>
          <div class="quantity-controls">
            <button onclick="decrement(${originalIndex})">‚àí</button>
            <span>${item.quantity}</span>
            <button onclick="increment(${originalIndex})">+</button>
          </div>
          <div class="item-price">R$ ${itemTotalPrice.toFixed(2)}</div>
        `;

        cartList.appendChild(li);
      });

      const total = carrinho.reduce((acc, item) => {
        let price = 0;
        if (item.type === 'inteira') {
          const pizza = pizzas.find(p => p.id === item.pizzaId);
          price = pizza.price;
        } else if (item.type === 'meia') {
          if (item.pizzas.length === 1) {
            const pizza = pizzas.find(p => p.id === item.pizzas[0]);
            price = pizza.price / 2;
          } else if (item.pizzas.length === 2) {
            const pizza1 = pizzas.find(p => p.id === item.pizzas[0]);
            const pizza2 = pizzas.find(p => p.id === item.pizzas[1]);
            price = Math.max(pizza1.price, pizza2.price);
          }
        } else if (item.type === 'bebida') {
          const bebida = bebidas.find(b => b.id === item.bebidaId);
          price = bebida.price;
        }
        return acc + price * item.quantity;
      }, 0);

      totalEl.textContent = `Total: R$ ${total.toFixed(2)}`;
    }

    function increment(index) {
      carrinho[index].quantity++;
      carrinho[index].timestamp = Date.now(); // Atualiza o timestamp ao incrementar
      renderCart();
    }

    function decrement(index) {
      if (carrinho[index].quantity > 1) {
        carrinho[index].quantity--;
        carrinho[index].timestamp = Date.now(); // Atualiza o timestamp ao decrementar
      } else {
        if (meiaPizzaPendente !== null && carrinho[index].type === 'meia' && carrinho[index].pizzas[0] === meiaPizzaPendente) {
          meiaPizzaPendente = null;
        }
        carrinho.splice(index, 1);
      }
      renderCart();
    }

    function abrirModalFinalizar() {
      modalFinalizar.classList.add('active');
    }

    function fecharModalFinalizar() {
      modalFinalizar.classList.remove('active');
    }

    function formatarPedidoParaWhatsApp() {
      let mensagem = "üçï *Pedido Pizzaria Del√≠cia* üçï\n\n";
      mensagem += "*Itens do Pedido:*\n";
      
      carrinho.forEach(item => {
        let name, price;
        
        if (item.type === 'inteira') {
          const pizza = pizzas.find(p => p.id === item.pizzaId);
          name = pizza.name;
          price = pizza.price;
        } else if (item.type === 'meia') {
          if (item.pizzas.length === 1) {
            const pizza = pizzas.find(p => p.id === item.pizzas[0]);
            name = `Meia pizza de ${pizza.name} (escolha outra metade)`;
            price = pizza.price / 2;
          } else if (item.pizzas.length === 2) {
            const pizza1 = pizzas.find(p => p.id === item.pizzas[0]);
            const pizza2 = pizzas.find(p => p.id === item.pizzas[1]);
            name = `Meia ${pizza1.name} + meia ${pizza2.name}`;
            price = Math.max(pizza1.price, pizza2.price);
          }
        } else if (item.type === 'bebida') {
          const bebida = bebidas.find(b => b.id === item.bebidaId);
          name = bebida.name;
          price = bebida.price;
        }
        
        mensagem += `- ${name} x${item.quantity} - R$ ${(price * item.quantity).toFixed(2)}\n`;
      });
      
      const total = carrinho.reduce((acc, item) => {
        let price = 0;
        if (item.type === 'inteira') {
          const pizza = pizzas.find(p => p.id === item.pizzaId);
          price = pizza.price;
        } else if (item.type === 'meia') {
          if (item.pizzas.length === 1) {
            const pizza = pizzas.find(p => p.id === item.pizzas[0]);
            price = pizza.price / 2;
          } else if (item.pizzas.length === 2) {
            const pizza1 = pizzas.find(p => p.id === item.pizzas[0]);
            const pizza2 = pizzas.find(p => p.id === item.pizzas[1]);
            price = Math.max(pizza1.price, pizza2.price);
          }
        } else if (item.type === 'bebida') {
          const bebida = bebidas.find(b => b.id === item.bebidaId);
          price = bebida.price;
        }
        return acc + price * item.quantity;
      }, 0);
      
      mensagem += `\n*Total: R$ ${total.toFixed(2)}*\n\n`;
      mensagem += `*Endere√ßo de Entrega:*\n${document.getElementById('endereco').value}, ${document.getElementById('numero').value}`;
      
      const complemento = document.getElementById('complemento').value;
      if (complemento) {
        mensagem += ` - ${complemento}`;
      }
      
      mensagem += `\n\n*Forma de Pagamento:* ${document.getElementById('pagamento').value}`;
      
      const troco = document.getElementById('troco').value;
      if (troco && document.getElementById('pagamento').value === 'Dinheiro') {
        mensagem += `\n*Troco para:* ${troco}`;
      }
      
      return encodeURIComponent(mensagem);
    }

    // Event listeners
    toggleMenuBtn.addEventListener('click', toggleMenu);
    btnFinalizar.addEventListener('click', abrirModalFinalizar);
    closeModal.addEventListener('click', fecharModalFinalizar);
    
    // Fechar modal ao clicar fora
    modalFinalizar.addEventListener('click', (e) => {
      if (e.target === modalFinalizar) {
        fecharModalFinalizar();
      }
    });
    
    // Mostrar campo de troco quando selecionar Dinheiro
    pagamentoSelect.addEventListener('change', () => {
      if (pagamentoSelect.value === 'Dinheiro') {
        trocoField.style.display = 'block';
      } else {
        trocoField.style.display = 'none';
      }
    });
    
    // Enviar pedido via WhatsApp
    formFinalizar.addEventListener('submit', (e) => {
      e.preventDefault();
      
      const telefonePizzaria = "5511999999999"; // Substitua pelo n√∫mero real da pizzaria
      const mensagem = formatarPedidoParaWhatsApp();
      const urlWhatsApp = `https://wa.me/${telefonePizzaria}?text=${mensagem}`;
      
      window.open(urlWhatsApp, '_blank');
      fecharModalFinalizar();
      
      // Limpar carrinho ap√≥s enviar
      carrinho = [];
      meiaPizzaPendente = null;
      renderCart();
      formFinalizar.reset();
    });

    // Inicializa√ß√£o
    renderMenu();
    renderCart();
  </script>
</body>
</html>
